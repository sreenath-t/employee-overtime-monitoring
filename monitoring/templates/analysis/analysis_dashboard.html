<!DOCTYPE html>
<html>
    <head>
      <title>Analysis</title>
      {% load static %}
      <link rel="stylesheet" href="{% static 'monitoring/css/analysis_dashboard.css' %}">
    </head>
    <body>
        <h2>Total Overtime by Employee</h2>
        <ul>
            {% for row in overtime_summary %}
            <li>{{ row.name }} ({{ row.department }}): {{ row.overtime_hours }} hrs</li>
            {% endfor %}
        </ul>

        <h2>Total Overtime by Department</h2>
        <ul>
            {% for row in department_overtime %}
            <li>{{ row.department }}: {{ row.overtime_hours }} hrs</li>
            {% endfor %}
        </ul>

        <h2>High Overtime Employees</h2>
        <ul>
            {% for row in high_overtime_emp %}
            <li>{{ row.name }}: {{ row.overtime_hours }} hrs</li>
            {% endfor %}
        </ul>

        <h2>High Overtime Departments</h2>
        <ul>
            {% for row in high_overtime_dep %}
            <li>{{row.department}}: {{row.overtime_hours}} hrs</li>
            {% endfor %}
        </ul>

        <h2>Monthly Overtime Trends</h2>
        <ul>
            {% for row in monthly_trends %}
            <li>{{ row.month }} - {{ row.department }}: {{ row.overtime_hours }} hrs</li>
            {% endfor %}
        </ul>

        <h2>Overtime by Day of Week</h2>
        <ul>
            {% for row in weekday_overtime %}
            <li>{{ row.day_of_week }}: {{ row.overtime_hours }} hrs</li>
            {% endfor %}
        </ul>

        <h2>Employees with Consistently High Overtime</h2>
        {% if consistent_high %}
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Emp ID</th>
                    <th>Department</th>
                    <th>Total Days (x)</th>
                    <th>High Overtime Days (y)</th>
                    <th>High Overtime Ratio (= y/x) (in %)</th>
                </tr>
            </thead>
            <tbody>
                {% for emp in consistent_high %}
                <tr>
                    <td>{{ emp.name }}</td>
                    <td>{{ emp.employee_id }}</td>
                    <td>{{ emp.department }}</td>
                    <td>{{ emp.total_days }}</td>
                    <td>{{ emp.high_days }}</td>
                    <td>{{ emp.high_ratio|floatformat:2 }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
            <p>No employees meet the consistent high overtime criteria.</p>
        {% endif %}
    </body>
</html>